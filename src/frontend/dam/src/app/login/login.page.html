<!-- No header - pantalla completa como la imagen -->

<ion-content class="login-content">
  <div class="container">
    <!-- LADO IZQUIERDO - INFORMACIÃ“N DEL PORTAL -->
    <div class="welcome-section">
      <div class="welcome-content">
        <div class="sensor-icon">ğŸ“Š</div>
        <h1>Portal de Sensores</h1>
        <p>Bienvenido a nuestro sistema de monitoreo inteligente. Gestiona tus proyectos de sensores MPU y accede a datos en tiempo real de manera segura y eficiente.</p>
        <div class="features">
          <p>âœ¨ Hasta 2 proyectos por usuario</p>
          <p>ğŸ“ˆ Monitoreo en tiempo real</p>
          <p>ğŸ”’ Acceso seguro con token</p>
        </div>
      </div>
    </div>

    <!-- LADO DERECHO - FORMULARIOS -->
    <div class="form-section">
      <div class="form-container">
        
        <!-- TOGGLE ENTRE LOGIN Y REGISTRO - SIEMPRE VISIBLE -->
        <div class="form-toggle">
          <ion-button 
            fill="clear" 
            [class.active]="currentForm === 'login'"
            (click)="showLogin()">
            Iniciar SesiÃ³n
          </ion-button>
          <ion-button 
            fill="clear" 
            [class.active]="currentForm === 'register'"
            (click)="showRegister()">
            Registrarse
          </ion-button>
        </div>

        <!-- ÃREA DE CONTENIDO CON SCROLL -->
        <div class="form-content">
          
          <!-- MENSAJES DE ESTADO -->
          <ion-card class="message-card error" *ngIf="errorMessage">
            <ion-card-content>
              <ion-icon name="alert-circle-outline"></ion-icon>
              {{ errorMessage }}
            </ion-card-content>
          </ion-card>

          <ion-card class="message-card success" *ngIf="successMessage">
            <ion-card-content>
              <ion-icon name="checkmark-circle-outline"></ion-icon>
              {{ successMessage }}
            </ion-card-content>
          </ion-card>

          <!-- FORMULARIO DE LOGIN -->
          <form *ngIf="currentForm === 'login'" [formGroup]="loginForm" (ngSubmit)="onLogin()" class="auth-form active">
            <h2>Iniciar SesiÃ³n</h2>
            
            <div class="form-group">
              <ion-item class="form-item" lines="none">
                <ion-label position="stacked">Usuario</ion-label>
                <ion-input 
                  formControlName="usuario"
                  type="text" 
                  placeholder="Ingresa tu nombre de usuario"
                  [class.error]="loginForm.get('usuario')?.invalid && loginForm.get('usuario')?.touched">
                </ion-input>
              </ion-item>
              <div class="error-text" *ngIf="loginForm.get('usuario')?.invalid && loginForm.get('usuario')?.touched">
                El usuario es requerido
              </div>
            </div>

            <div class="form-group">
              <div class="password-container">
                <ion-item class="form-item" lines="none">
                  <ion-label position="stacked">ContraseÃ±a</ion-label>
                  <ion-input 
                    formControlName="password"
                    [type]="showLoginPassword ? 'text' : 'password'"
                    placeholder="Ingresa tu contraseÃ±a"
                    [class.error]="loginForm.get('password')?.invalid && loginForm.get('password')?.touched">
                  </ion-input>
                </ion-item>
                <ion-button 
                  fill="clear" 
                  (click)="togglePasswordVisibility('login')"
                  class="password-toggle-btn">
                  {{ showLoginPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸' }}
                </ion-button>
              </div>
              <div class="error-text" *ngIf="loginForm.get('password')?.invalid && loginForm.get('password')?.touched">
                La contraseÃ±a es requerida
              </div>
            </div>

            <ion-button 
              type="submit" 
              expand="block" 
              [disabled]="loginForm.invalid || isLoading"
              [class.loading]="isLoading"
              class="submit-btn">
              <span *ngIf="!isLoading">Ingresar al Portal</span>
              <span *ngIf="isLoading">Ingresando...</span>
            </ion-button>
          </form>

          <!-- FORMULARIO DE REGISTRO -->
          <form *ngIf="currentForm === 'register'" [formGroup]="registerForm" (ngSubmit)="onRegister()" class="auth-form active">
            <h2>Crear Cuenta</h2>
            
            <div class="form-group">
              <ion-item class="form-item" lines="none">
                <ion-label position="stacked">Nombre Completo</ion-label>
                <ion-input 
                  formControlName="nombre"
                  type="text" 
                  placeholder="Ingresa tu nombre completo"
                  [class.error]="registerForm.get('nombre')?.invalid && registerForm.get('nombre')?.touched">
                </ion-input>
              </ion-item>
              <div class="error-text" *ngIf="registerForm.get('nombre')?.invalid && registerForm.get('nombre')?.touched">
                El nombre es requerido
              </div>
            </div>

            <div class="form-group">
              <ion-item class="form-item" lines="none">
                <ion-label position="stacked">Correo ElectrÃ³nico</ion-label>
                <ion-input 
                  formControlName="correo"
                  type="email" 
                  placeholder="ejemplo@correo.com"
                  [class.error]="registerForm.get('correo')?.invalid && registerForm.get('correo')?.touched">
                </ion-input>
              </ion-item>
              <div class="error-text" *ngIf="registerForm.get('correo')?.invalid && registerForm.get('correo')?.touched">
                <span *ngIf="registerForm.get('correo')?.errors?.['required']">El correo es requerido</span>
                <span *ngIf="registerForm.get('correo')?.errors?.['email']">Formato de correo invÃ¡lido</span>
              </div>
            </div>

            <div class="form-group">
              <ion-item class="form-item" lines="none">
                <ion-label position="stacked">Nombre de Usuario</ion-label>
                <ion-input 
                  formControlName="usuario"
                  type="text" 
                  placeholder="Elige un nombre de usuario Ãºnico"
                  [class.error]="registerForm.get('usuario')?.invalid && registerForm.get('usuario')?.touched">
                </ion-input>
              </ion-item>
              <div class="error-text" *ngIf="registerForm.get('usuario')?.invalid && registerForm.get('usuario')?.touched">
                El nombre de usuario es requerido
              </div>
            </div>

            <div class="form-group">
              <ion-item class="form-item" lines="none">
                <ion-label position="stacked">Token de Acceso</ion-label>
                <ion-input 
                  formControlName="token"
                  type="text" 
                  placeholder="Ingresa tu token de acceso"
                  [class.error]="registerForm.get('token')?.invalid && registerForm.get('token')?.touched">
                </ion-input>
              </ion-item>
              <div class="token-help">Token proporcionado por el administrador del sistema</div>
              <div class="error-text" *ngIf="registerForm.get('token')?.invalid && registerForm.get('token')?.touched">
                <span *ngIf="registerForm.get('token')?.errors?.['required']">El token es requerido</span>
                <span *ngIf="registerForm.get('token')?.errors?.['minlength']">El token debe tener al menos 6 caracteres</span>
              </div>
            </div>

            <div class="form-group">
              <div class="password-container">
                <ion-item class="form-item" lines="none">
                  <ion-label position="stacked">ContraseÃ±a</ion-label>
                  <ion-input 
                    formControlName="password"
                    [type]="showRegisterPassword ? 'text' : 'password'"
                    placeholder="Crea una contraseÃ±a segura"
                    [class.error]="registerForm.get('password')?.invalid && registerForm.get('password')?.touched"
                    (ionInput)="checkPasswordStrength()">
                  </ion-input>
                </ion-item>
                <ion-button 
                  fill="clear" 
                  (click)="togglePasswordVisibility('register')"
                  class="password-toggle-btn">
                  {{ showRegisterPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸' }}
                </ion-button>
              </div>
              <div class="password-strength" [ngClass]="passwordStrength.class" *ngIf="registerForm.get('password')?.value">
                {{ passwordStrength.text }}
              </div>
              <div class="error-text" *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">
                <span *ngIf="registerForm.get('password')?.errors?.['required']">La contraseÃ±a es requerida</span>
                <span *ngIf="registerForm.get('password')?.errors?.['minlength']">La contraseÃ±a debe tener al menos 8 caracteres</span>
              </div>
            </div>

            <div class="form-group">
              <div class="password-container">
                <ion-item class="form-item" lines="none">
                  <ion-label position="stacked">Confirmar ContraseÃ±a</ion-label>
                  <ion-input 
                    formControlName="confirmPassword"
                    [type]="showConfirmPassword ? 'text' : 'password'"
                    placeholder="Confirma tu contraseÃ±a"
                    [class.error]="registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched">
                  </ion-input>
                </ion-item>
                <ion-button 
                  fill="clear" 
                  (click)="togglePasswordVisibility('confirm')"
                  class="password-toggle-btn">
                  {{ showConfirmPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸' }}
                </ion-button>
              </div>
              <div class="error-text" *ngIf="registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched">
                <span *ngIf="registerForm.get('confirmPassword')?.errors?.['required']">Confirma tu contraseÃ±a</span>
                <span *ngIf="registerForm.get('confirmPassword')?.errors?.['passwordMismatch']">Las contraseÃ±as no coinciden</span>
              </div>
            </div>

            <ion-button 
              type="submit" 
              expand="block" 
              [disabled]="registerForm.invalid || isLoading"
              [class.loading]="isLoading"
              class="submit-btn">
              <span *ngIf="!isLoading">Crear Cuenta</span>
              <span *ngIf="isLoading">Creando cuenta...</span>
            </ion-button>
          </form>

        </div> <!-- Fin form-content -->
      </div>
    </div>
  </div>
</ion-content>